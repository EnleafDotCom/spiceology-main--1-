<section x-data="{ fadeIn: false }" x-intersect.threshold.20="fadeIn = true" :class="fadeIn && 'animate-fade-in-500'" class="opacity-0 section-p-b {{ section.settings.padding_bottom }}">
    <div class="flex flex-col items-start lg:px-5">
        <h5 class="heading-lg lg:heading-xl pb-7 lg:pb-10 px-5 lg:px-0">{{ section.settings.heading }}</h5>
        <button-slider  
                data-slider-options='
                  {
                    "breakpoints": {
                      "(max-width: 1024px)": {
                        "mode": "snap",
                        "rtl": false,
                        "loop": true,
                        "slides": { "perView": "1.2", "spacing": 0 }
                      },
                      "(min-width: 1024px)": {
                        "disabled": true
                      }
                    }
                  }
                ' class="w-full "
        >
            <div class="keen-slider flex overflow-x-hidden ">
                <div class="flex lg:grid lg:grid-cols-3 lg:gap-x-4 lg:gap-y-14">
                    {% for block in section.blocks %}
                        {% assign collection = block.settings.collection %}
                        {% if block.settings.image %}
                            {% assign image = block.settings.image %}
                        {% else %}
                            {% assign image = collection.image %}
                        {% endif %}
                        <a href="{{ collection.url }}" class="keen-slider__slide flex flex-col items-start pl-[15px] lg:pl-0">
                            <img src="{{ image | img_url: '800x' }}" class="w-full aspect-[1.52] object-cover mb-2.5 lg:mb-4 rounded-6"/>
                            <div class="flex flex-col w-fit">
                                <div class="flex gap-2 pb-2">
                                    {% if collection.metafields.custom.color %}
                                        <span style="background-color: {{ collection.metafields.custom.color }};" class="w-5 h-5 rounded-full" class="m-1"></span>
                                    {% endif %}
                                    <h6 class="heading-md lg:heading-sm">
                                        <span>{{ collection.title }}</span>
                                        <sup class="utility-lg opacity-75 top-[-9px] lg:top-[-6px]">{{ collection.all_products_count }}</sup>
                                    </h6>
                                </div>
                                <p class="body-md w-full lg:w-3/4 pb-4 pr-8 lg:pr-0">{{ block.settings.description }}</p>
                                <span class="button__primary w-fit">Shop {{ collection.title }}</span>
                            </div>
                        </a>
                    {% endfor %}
                </div>
            </div>
        </button-slider>
    </div>
</section>

{% schema %}  
    {
        "name": "Periodic Collection Grid",
        "settings": [
            {
                "type": "text",
                "id": "heading",
                "label": "Heading"
            },
            {
                "type": "select",
                "id": "padding_bottom",
                "label": "Padding Bottom",
                "default": "medium",
                "options": [
                    {
                        "value": "small",
                        "label": "Small"
                    },
                    {
                        "value": "medium",
                        "label": "Medium"
                    },
                    {
                        "value": "large",
                        "label": "Large"
                    }
                ]
            }
        ],
        "blocks": [
            {
                "type": "collection",
                "name": "Collection",
                "settings": [
                    {
                        "type": "collection",
                        "id": "collection",
                        "label": "Collection"
                    },
                    {
                        "type": "image_picker",
                        "id": "image",
                        "label": "Image",
                        "info": "Aspect Ratio: 2x3 | Min Width: 800px | File Type: PNG"
                    },
                    {
                        "type": "textarea",
                        "id": "description",
                        "label": "Description"
                    }
                ]
            }
        ],
        "enabled_on": {
            "templates": [
                "index",
                "page"
            ]
        },
        "presets": [
            {
                "name": "Periodic Collection Grid",
                "settings": {
                    "heading": "Shop by Collection"
                },
                "blocks": [
                    {
                        "type": "collection",
                        "settings": {
                            "collection": "salts",
                            "image": "",
                            "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempus purus."
                        }
                    },
                    {
                        "type": "collection",
                        "settings": {
                            "collection": "herbs",
                            "image": "",
                            "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempus purus."
                        }
                    },
                    {
                        "type": "collection",
                        "settings": {
                            "collection": "spices",
                            "image": "",
                            "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempus purus."
                        }
                    },
                    {
                        "type": "collection",
                        "settings": {
                            "collection": "chiles",
                            "image": "",
                            "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempus purus."
                        }
                    },
                    {
                        "type": "collection",
                        "settings": {
                            "collection": "confections",
                            "image": "",
                            "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempus purus."
                        }
                    },
                    {
                        "type": "collection",
                        "settings": {
                            "collection": "powders",
                            "image": "",
                            "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempus purus."
                        }
                    }

                ]
            }
        ]
    }
{% endschema %}