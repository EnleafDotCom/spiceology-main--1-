<section x-data="{ fadeIn: false }" x-intersect.threshold.20="fadeIn = true" :class="fadeIn && 'animate-fade-in-500'" class="lg:px-5 lg:py-12 px-2.5 py-5 opacity-0">
  <h2 class="lg:mb-12 mb-5 heading-lg">{{ section.settings.title }}</h2>
  {% if section.settings.hero_image %}
    <div class="relative">
      {% render 'image', 
        image_desktop: section.settings.hero_image,  
        width_desktop: '2000x', 
        width_mobile: '700x',
        lazy: true,
        image_classes: 'rounded-6 lg:h-[654px] h-[605px] w-full object-cover' 
      %}
      <div class="absolute lg:left-12 lg:bottom-13 lg:right-auto left-6 right-6 bottom-6 lg:text-left text-center text-{{ section.settings.color }}">
        {% if section.settings.heading != blank %}
        <h3 class="heading-xl mb-2.5">{{ section.settings.heading }}</h3>
        {% endif %}
        {% if section.settings.description != blank %}
        <p class="body-lg lg:mb-4 mb-5">{{ section.settings.description }}</p>
        {% endif %}
        {% if section.settings.button_text != blank %}
        <a class="{{ section.settings.button_type }} text-16 leading-130 tracking-3 lg:m-0 m-auto" href="{{ section.settings.button_url }}">{{ section.settings.button_text }}</a>
        {% endif %}
      </div>
    </div>
  {% endif %}

  <div class="grid grid-cols-12 lg:gap-5 gap-2.5 justify-center">
    {% for block in section.blocks %}
      {% if section.blocks.size == 1 %}
      <div class="col-span-3 lg:block hidden"></div>
      {% endif %}
      <div class="{% if section.blocks.size <= 2 %} lg:col-span-6 {% endif %} {% if section.blocks.size == 3 %} lg:col-span-4 {% endif %} {% if section.blocks.size == 4 %} lg:col-span-3 {% endif %} {% if section.settings.mobile_column_count == "1" %} col-span-full {% else %} col-span-6 {% endif %} relative">
        <a href="{{ block.settings.button_url }}">
          {% assign image_classes = 'rounded-6 w-full object-cover aspect-' | append: section.settings.image_ratio %}
          {% render 'image', 
            image_desktop: block.settings.image,  
            width_desktop: '1000x', 
            width_mobile: '500x',
            lazy: true,
            image_classes: image_classes
          %}
        </a>
        <div class="{% if section.settings.content_position == "inside" %} absolute {% else %} lg:py-4 py-5 {% endif %} lg:left-12 lg:bottom-13 lg:right-auto left-6 right-6 bottom-6 text-{{ block.settings.color }} lg:text-{{ section.settings.content_alignment_desk }} text-{{ section.settings.content_alignment_mob }} ">
          {% if block.settings.heading != blank %}
          <h3 class="{% if section.blocks.size < 4 %} lg:text-40 {% endif %} {% if section.settings.mobile_column_count == "1" %} text-30 {% else %} text-22 {% endif %} {% if section.settings.content_position == "inside" %} mb-2.5 {% else %} lg:mb-2 mb-1 {% endif %} leading-95">{{ block.settings.heading }}</h3>
          {% endif %}
          {% if block.settings.description != blank %}
          <p class="body-md {% if section.settings.content_position == "inside" %} lg:mb-4 mb-5 {% else %} lg:mb-5 mb-4 {% endif %}">{{ block.settings.description }}</p>
          {% endif %}
          {% if block.settings.button_text != blank %}
            <a class="{% if section.settings.mobile_link_type == "plain" %} lg:flex hidden {% endif %} {{ block.settings.button_type }} lg:m-0 m-auto" href="{{ block.settings.button_url }}">{{ block.settings.button_text }}</a>
            {% if section.settings.mobile_link_type == "plain" %}
            <a class="lg:hidden block lg:m-0 m-auto underline" href="{{ block.settings.button_url }}">{{ block.settings.button_text }}</a>
            {% endif %}
          {% endif %}
        </div>
      </div>
      {% if section.blocks.size == 1 %}
      <div class="col-span-3 lg:block hidden"></div>
      {% endif %}
    {% endfor %}
  </div>
</section>

{% schema %}
  {
    "name": "Rich Image",
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Title"
      },
      {
        "type": "image_picker",
        "id": "hero_image",
        "label": "Hero Image"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "Heading"
      },
      {
        "type": "textarea",
        "id": "description",
        "label": "Description"
      },
      {
        "type": "url",
        "id": "button_url",
        "label": "Button URL"
      },
      {
        "type": "select",
        "id": "color",
        "label": "Color",
        "options": [
          {
            "value": "white",
            "label": "White"
          },
          {
            "value": "black",
            "label": "Black"
          }
        ]
      },
      {
        "type": "text",
        "id": "button_text",
        "label": "Button Text"
      },
      {
        "type": "select",
        "id": "button_type",
        "label": "Button Type",
        "options": [
          {
            "value": "button__primary",
            "label": "Primary"
          },
          {
            "value": "button__secondary",
            "label": "Secondary"
          }
        ]
      },
      {
        "type": "select",
        "id": "mobile_link_type",
        "label": "Mobile Link Type",
        "options": [
          {
            "value": "plain",
            "label": "Plain"
          },
          {
            "value": "button",
            "label": "Button"
          }
        ]
      },
      {
        "type": "select",
        "id": "mobile_column_count",
        "label": "Mobile Column Count",
        "options": [
          {
            "value": "1",
            "label": "1"
          },
          {
            "value": "2",
            "label": "2"
          }
        ]
      },
      {
        "type": "select",
        "id": "content_position",
        "label": "Content Position",
        "options": [
          {
            "value": "inside",
            "label": "Inside"
          },
          {
            "value": "outside",
            "label": "Outside"
          }
        ]
      },
      {
        "type": "select",
        "id": "content_alignment_desk",
        "label": "Content Alignment Desktop",
        "options": [
          {
            "value": "center",
            "label": "Center"
          },
          {
            "value": "left",
            "label": "Left"
          }
        ]
      },
      {
        "type": "select",
        "id": "content_alignment_mob",
        "label": "Content Alignment Mobile",
        "options": [
          {
            "value": "center",
            "label": "Center"
          },
          {
            "value": "left",
            "label": "Left"
          }
        ]
      },
      {
        "type": "select",
        "id": "image_ratio",
        "label": "Image Ratio",
        "options": [
          {
            "label": "Square",
            "value": "square"
          },
          {
            "label": "4:3",
            "value": "4/3"
          },
          {
            "label": "3:4",
            "value": "3/4"
          },
          {
            "label": "16:9",
            "value": "16/9"
          },
          {
            "label": "9:16",
            "value": "9/16"
          },
          
        ],
        "default": "square"
      },
    ],
    "blocks": [
      {
        "name": "image",
        "type": "Image",
        "limit": 4,
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading"
          },
          {
            "type": "textarea",
            "id": "description",
            "label": "Description"
          },
          {
            "type": "url",
            "id": "button_url",
            "label": "Button URL"
          },
          {
            "type": "text",
            "id": "button_text",
            "label": "Button Text"
          },
          {
            "type": "select",
            "id": "color",
            "label": "Color",
            "options": [
              {
                "value": "white",
                "label": "White"
              },
              {
                "value": "black",
                "label": "Black"
              }
            ]
          },
          {
            "type": "select",
            "id": "button_type",
            "label": "Button Type",
            "options": [
              {
                "value": "button__primary",
                "label": "Primary"
              },
              {
                "value": "button__secondary",
                "label": "Secondary"
              }
            ]
          },
        ]
      }
    ],
    "presets": [
      {
        "name": "Rich Image",
        "blocks": [
          {
            "type": "Image",
            "settings": {
              "image": "shopify:\/\/shop_images\/f92bb9b29ddd12ecec938c8c04ade9f1.jpg",
              "heading": "This is a headline",
              "description": "This is a subheadline lorem ipsum dolor sit amet",
              "button_url": "",
              "button_text": "Shop Now",
              "color": "black",
              "button_type": "button__primary"
            }
          },
          {
            "type": "Image",
            "settings": {
              "image": "shopify:\/\/shop_images\/38615fd320fdd431aff111c9cd635ce8.png",
              "heading": "This is a headline",
              "description": "This is a subheadline lorem ipsum dolor sit amet",
              "button_url": "",
              "button_text": "Shop Now",
              "color": "black",
              "button_type": "button__primary"
            }
          }
        ],
        "settings": {
          "title": "3B: 2-up Square Image  w\/ content",
          "heading": "",
          "description": "",
          "button_url": "",
          "color": "black",
          "button_text": "",
          "button_type": "button__secondary",
          "mobile_link_type": "plain",
          "mobile_column_count": "2",
          "content_position": "outside",
          "content_alignment_desk": "left",
          "content_alignment_mob": "left"
        }
      }
    ],
  }
{% endschema %}
